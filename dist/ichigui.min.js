/**!
 * ichigui v0.0.1-alpha.10
 * License: MIT
 * https://github.com/literallylara/ichigui#readme
 */var IG=function(){'use strict';const a=(b,...c)=>{let d=null,e=null,f=null;if(0==c.length&&(d=[],e={}),c[0]instanceof Array?(d=c[0],e={}):c[0]instanceof Object?(d=c[1]||[],e=c[0]):"string"==typeof c[0]&&(f=c[0]),"function"==typeof b){const a=new b(e,d,f),c=a.render();return c.component=a,a.vdom=c,c}if("object"==typeof b&&b.render){const a=b,c=b.render(e,d,f);return c.component=a,a.vdom=c,c}const g={tag:b,attributes:e,children:d,text:f,dom:null};return e&&(e.mount&&(g.onMount=e.mount,delete e.mount),e.unmount&&(g.onUnmount=e.unmount,delete e.unmount)),g.children&&(g.children=g.children.slice(0),g.children.forEach((b,c)=>{"string"==typeof b?g.children[c]=a("#",b):("function"==typeof b||"object"==typeof b&&b.render)&&(g.children[c]=a(b)),g.children[c].parent=g})),g},b=a=>{let b=null;if("#"==a.tag)return document.createTextNode(a.text);if(b="[]"==a.tag?document.createDocumentFragment():document.createElementNS(a.namespaceURI||"http://www.w3.org/1999/xhtml",a.tag),a.attributes)for(let c in a.attributes){let d=a.attributes[c];"function"==typeof d?b.addEventListener(c,d):void 0!==d&&b.setAttributeNS(d.namespaceURI,c,d)}return a.text&&(b.textContent=a.text),a.children&&a.children.forEach(a=>d(b,a)),b},d=(a,c,d)=>{const f="number"==typeof d?d:-1;if(c.onBeforeMount&&c.onBeforeMount.call(c),"boolean"==typeof d&&d&&a.childNodes)for(;a.childNodes.length;){let b=a.childNodes[a.childNodes.length-1];b._vdom?e(b._vdom):b.remove()}if(c.dom=b(c),c.dom._vdom=c,0<=f){const b=a.children[f];b?b.insertAdjacentElement("beforebegin",c.dom):a.appendChild(c.dom)}else a.appendChild(c.dom);c.onMount&&c.onMount.call(c)},e=a=>{if(!a.dom)throw new Error("Attempted to unmount with no dom present.");a.onBeforeUnmount&&a.onBeforeUnmount.call(a),a.children&&a.children.forEach(a=>e(a)),a.dom&&(a.parent&&(a.index=a.parent.children.indexOf(a)),a.dom.remove()),a.onUnmount&&a.onUnmount.call(a)},f=(c,a)=>{if(!c.dom)throw new Error("Attempted to patch Vnode without dom.");c.dom.parentNode||d(c.parent.dom,c,c.index);const b=c.dom;if(c.tag!==a.tag){const f=b.parentNode;return e(c),d(f,a),a}const g=c.attributes||[],h=a.attributes||[];Object.keys(g).concat(Object.keys(h)).forEach(a=>{const c=g[a],d=h[a];d===void 0?"function"==typeof c?b.removeEventListener(a,c):(b[a]=d,b.removeAttribute(a)):d!==c&&("function"==typeof d?(b.removeEventListener(a,c),b.addEventListener(a,d)):(b[a]=d,b.setAttributeNS(null,a,d)))});const j=c.children||[],k=a.children||[],l=Math.max(j.length,k.length);for(let g=0;g<l;g++){const a=j[g],c=k[g];a&&c?f(a,c):c?d(b,c):e(a)}c.text!=a.text&&(b.textContent=a.text),a.dom=b},g=window.crypto||window.msCrypto,h=()=>"10000000-1000-4000-8000-100000000000".replace(/[018]/g,a=>{const b=g.getRandomValues(new Uint8Array(1))[0];return(a^b&15>>a/4).toString(16)});return{createElement:a,Component:class a{constructor(a={},b=[]){this.props=Object.seal(Object.assign({},a)),this.state={},this.children=b}setState(){let a;if("string"==typeof arguments[0]){const b=arguments[0],c=arguments[1];this.state[b]=c,a=arguments[2]}else{const b=arguments[0];for(let a in b)this.state[a]=b[a];a=arguments[1]}(a||a===void 0)&&this.update()}saveState(){this.props.key||(this.props.key=h());try{const a=JSON.stringify({timestamp:Date.now(),data:this.state});return window.localStorage.setItem(this.props.key,a),!0}catch(a){return!1}}getSavedState(){if(this.props.key){const a=window.localStorage.getItem(this.props.key);if(a)try{return JSON.parse(a)}catch(a){}}}loadState(){if(!this.props.key)return!1;const a=window.localStorage.getItem(this.props.key);if(!a)return!1;try{const b=JSON.parse(a);return!!b.data&&(Object.assign(this.state,b.data),!0)}catch(a){return!1}}mount(a){return this.vdom?void console.warn("Component already mounted."):void(this.onBeforeMount&&this.onBeforeMount(),this.props.onBeforeMount&&this.props.onBeforeMount(),this.vdom=this.render(),this.vdom.root=!0,this.vdom.parent=a,this.vdom.component=this,d(a,this.vdom),this.onMount&&this.onMount(),this.props.onMount&&this.props.onMount())}unmount(){return this.vdom&&this.vdom.dom?void(this.onBeforeUnmount&&this.onBeforeUnmount(),this.props.onBeforeUnmount&&this.props.onBeforeUnmount(),e(this.vdom),delete this.vdom,this.onUnmount&&this.onUnmount(),this.props.onUnmount&&this.props.onUnmount()):void console.warn("Attempted to unmount with no dom present.")}update(){if(!this.vdom)return;const a=this.vdom.parent,b=this.render();f(this.vdom,b),this.vdom=b,this.vdom.parent=a,this.vdom.component=this}},uuid:h}}();
