/**!
 * ichigui v0.0.1-alpha.12
 * License: MIT
 * https://github.com/literallylara/ichigui#readme
 */var IG=function(){'use strict';const a=window.crypto||window.msCrypto,b=()=>"10000000-1000-4000-8000-100000000000".replace(/[018]/g,b=>{const c=a.getRandomValues(new Uint8Array(1))[0];return(b^c&15>>b/4).toString(16)}),c=b=>b.filter((a,c)=>b.indexOf(a)===c),d=(a,...b)=>{let c=null,e=null,f=null;if(0==b.length&&(c=[],e={}),b[0]instanceof Array?(c=b[0],e={}):b[0]instanceof Object?(c=b[1]||[],e=b[0]):"string"==typeof b[0]&&(f=b[0]),"function"==typeof a){const b=new a(e,c,f),d=b.render();return d.component=b,b.vdom=d,d}if("object"==typeof a&&a.render){const b=a,d=a.render(e,c,f);return d.component=b,b.vdom=d,d}const g={tag:a,attributes:e,children:c,text:f,dom:null};return e&&(e.mount&&(g.onMount=e.mount,delete e.mount),e.unmount&&(g.onUnmount=e.unmount,delete e.unmount),e.key&&(g.key=e.key,delete e.key),Object.keys(e).forEach(a=>{e[a]={value:e[a]}})),g.children&&(g.children=g.children.slice(0),g.children.forEach((a,b)=>{"string"==typeof a?g.children[b]=d("#",a):("function"==typeof a||"object"==typeof a&&a.render)&&(g.children[b]=d(a)),g.children[b].parent=g})),g},e=a=>{let b=null;if("#"==a.tag)return document.createTextNode(a.text);if(b="[]"==a.tag?document.createDocumentFragment():document.createElementNS(a.namespaceURI||"http://www.w3.org/1999/xhtml",a.tag),a.attributes)for(let c in a.attributes){const d=a.attributes[c];"function"==typeof d.value?b.addEventListener(c,d.value):d.value&&b.setAttributeNS(d.namespaceURI,c,d.value)}return a.text&&(b.textContent=a.text),a.children&&a.children.forEach(a=>f(b,a)),b},f=(a,b,c)=>{const d="number"==typeof c?c:-1;if(b.onBeforeMount&&b.onBeforeMount.call(b),"boolean"==typeof c&&c&&a.childNodes)for(;a.childNodes.length;){let b=a.childNodes[a.childNodes.length-1];b._vdom?g(b._vdom):b.remove()}if(b.dom=e(b),b.dom._vdom=b,0<=d){const c=a.children[d];c?a.insertBefore(b.dom,a.children[d]):a.appendChild(b.dom)}else a.appendChild(b.dom);b.onMount&&b.onMount.call(b)},g=a=>{if(!a.dom)throw new Error("Attempted to unmount with no dom present.");a.onBeforeUnmount&&a.onBeforeUnmount.call(a),a.children&&a.children.forEach(a=>g(a)),a.dom&&(a.parent&&(a.index=a.parent.children.indexOf(a)),a.dom.remove()),a.onUnmount&&a.onUnmount.call(a)},h=(d,a)=>{var b=Math.min,e=Math.max;if(!d.dom)throw new Error("Attempted to patch Vnode without dom.");d.dom.parentNode||f(d.parent.dom,d,d.index);const j=d.dom;if(d.tag!==a.tag){const b=j.parentNode;return g(d),f(b,a),a}const l=d.attributes||{},m=a.attributes||{},n=c(Object.keys(l).concat(Object.keys(m)));for(let b=0;b<n.length;b++){const a=n[b];if("key"==a)continue;const c=l[a],d=m[a];d.value===void 0&&c.value!==void 0?"function"==typeof c.value?j.removeEventListener(a,c.value):(delete j[a],j.removeAttributeNS(c.namespaceURI,c.localName||a)):d.value!==c.value&&("function"==typeof d.value?c.value!==d.value&&(j.removeEventListener(a,c.value),j.addEventListener(a,d.value)):(j[a]=d.value,j.setAttributeNS(d.namespaceURI,a,d.value)))}const o=(d.children||[]).slice(0),p=(a.children||[]).slice(0);let q=e(o.length,p.length);for(let c=0;c<q;c++){const a=o[c],d=p[c];if(!(a&&d))d?f(j,d):g(a);else if(a.key!==d.key){const f=p.findIndex(b=>b.key===a.key);if(-1!=f){if(f==c){h(a,d);continue}const e=a.dom.parentNode;e.childNodes[f]?e.insertBefore(a.dom,e.childNodes[f]):e.appendChild(a.dom),o.splice(c,1),o.splice(b(f,o.length),0,a),c-=1}else o.splice(c,1),c-=1,q=e(o.length,p.length),a.dom.remove()}else h(a,d)}d.text!=a.text&&(j.textContent=a.text),a.dom=j};return{createElement:d,Component:class a{constructor(a={},b=[]){this.props=Object.seal(Object.assign({},a)),this.state={},this.children=b}setState(){let a;if(this.onBeforeSetState&&this.onBeforeSetState(),"string"==typeof arguments[0]){const b=arguments[0],c=arguments[1];this.state[b]=c,a=arguments[2]}else{const b=arguments[0];for(let a in b)this.state[a]=b[a];a=arguments[1]}this.onSetState&&this.onSetState(),(a||void 0===a)&&this.update()}saveState(){this.props.key||(this.props.key=b());try{const a=JSON.stringify({timestamp:Date.now(),data:this.state});return this.onBeforeSaveState&&this.onBeforeSaveState(),window.localStorage.setItem(this.props.key,a),this.onSaveState&&this.onSaveState(),!0}catch(a){return!1}}getSavedState(){if(this.props.key){const a=window.localStorage.getItem(this.props.key);if(a)try{return JSON.parse(a)}catch(a){}}}loadState(){if(!this.props.key)return!1;const a=window.localStorage.getItem(this.props.key);if(!a)return!1;try{const b=JSON.parse(a);return!!b.data&&(this.onBeforeLoadState&&this.onBeforeLoadState(),Object.assign(this.state,b.data),!0)}catch(a){return!1}this.onLoadState&&this.onLoadState()}mount(a){return this.vdom?void console.warn("Component already mounted."):void(this.onBeforeMount&&this.onBeforeMount(),this.props.onBeforeMount&&this.props.onBeforeMount(),this.vdom=this.render(),this.vdom.root=!0,this.vdom.parent=a,this.vdom.component=this,f(a,this.vdom),this.onMount&&this.onMount(),this.props.onMount&&this.props.onMount())}unmount(){return this.vdom&&this.vdom.dom?void(this.onBeforeUnmount&&this.onBeforeUnmount(),this.props.onBeforeUnmount&&this.props.onBeforeUnmount(),g(this.vdom),delete this.vdom,this.onUnmount&&this.onUnmount(),this.props.onUnmount&&this.props.onUnmount()):void console.warn("Attempted to unmount with no dom present.")}update(){if(!this.vdom)return;this.onBeforeUpdate&&this.onBeforeUpdate();const a=this.vdom.parent,b=this.render();h(this.vdom,b),this.vdom=b,this.vdom.parent=a,this.vdom.component=this,this.onUpdate&&this.onUpdate()}},uuid:b}}();
