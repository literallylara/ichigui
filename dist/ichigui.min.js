/**!
 * ichigui v0.0.1-alpha.13
 * License: MIT
 * https://github.com/literallylara/ichigui#readme
 */var IG=function(){'use strict';const a=window.crypto||window.msCrypto,b=()=>"10000000-1000-4000-8000-100000000000".replace(/[018]/g,b=>{const c=a.getRandomValues(new Uint8Array(1))[0];return(b^c&15>>b/4).toString(16)}),c=b=>b.filter((a,c)=>b.indexOf(a)===c),d=(a,...b)=>{let c=null,e=null,f=null;if(0==b.length&&(c=[],e={}),b[0]instanceof Array?(c=b[0],e={}):b[0]instanceof Object?(c=b[1]||[],e=b[0]):"string"==typeof b[0]&&(f=b[0]),"function"==typeof a){const b=new a(e,c,f),d=b.render();return d.component=b,b.vdom=d,d}if("object"==typeof a&&a.render){const b=a,d=a.render(e,c,f);return d.component=b,b.vdom=d,d}const g={tag:a,attributes:e,children:c,text:f,dom:null};return e&&(e.mount&&(g.onMount=e.mount,delete e.mount),e.unmount&&(g.onUnmount=e.unmount,delete e.unmount),e.key&&(g.key=e.key,delete e.key),Object.keys(e).forEach(a=>{e[a]={value:e[a]}})),g.children&&(g.children=g.children.slice(0),g.children.forEach((a,b)=>{"string"==typeof a?g.children[b]=d("#",a):("function"==typeof a||"object"==typeof a&&a.render)&&(g.children[b]=d(a)),g.children[b].parent=g})),g},e=a=>{let b=null;if("#"==a.tag)return document.createTextNode(a.text);if(b="[]"==a.tag?document.createDocumentFragment():document.createElementNS(a.namespaceURI||"http://www.w3.org/1999/xhtml",a.tag),a.attributes)for(let c in a.attributes){const d=a.attributes[c];"function"==typeof d.value?b.addEventListener(c,d.value):d.value&&b.setAttributeNS(d.namespaceURI,c,d.value)}return a.text&&(b.textContent=a.text),a.children&&a.children.forEach(a=>f(b,a)),b},f=(a,b,c)=>{const d="number"==typeof c?c:-1;if(b.onBeforeMount&&b.onBeforeMount.call(b),"boolean"==typeof c&&c&&a.childNodes)for(;a.childNodes.length;){let b=a.childNodes[a.childNodes.length-1];b._vdom?g(b._vdom):b.remove()}if(b.dom=e(b),b.dom._vdom=b,0<=d){const c=a.children[d];c?a.insertBefore(b.dom,a.children[d]):a.appendChild(b.dom)}else a.appendChild(b.dom);b.onMount&&b.onMount.call(b)},g=a=>{if(!a.dom)throw new Error("Attempted to unmount with no dom present.");a.onBeforeUnmount&&a.onBeforeUnmount.call(a),a.children&&a.children.forEach(a=>g(a)),a.dom&&(a.parent&&(a.index=a.parent.children.indexOf(a)),a.dom.remove()),a.onUnmount&&a.onUnmount.call(a)},h=(d,a)=>{if(!d.dom)throw new Error("Attempted to patch Vnode without dom.");d.dom.parentNode||f(d.parent.dom,d,d.index);const b=d.dom;if(d.tag!==a.tag){const c=b.parentNode;return g(d),f(c,a),a}const e=d.attributes||{},j=a.attributes||{},l=c(Object.keys(e).concat(Object.keys(j)));for(let c=0;c<l.length;c++){const a=l[c];if("key"==a)continue;const d=e[a],f=j[a];f.value===void 0&&d.value!==void 0?"function"==typeof d.value?b.removeEventListener(a,d.value):(delete b[a],b.removeAttributeNS(d.namespaceURI,d.localName||a)):f.value!==d.value&&("function"==typeof f.value?d.value!==f.value&&(b.removeEventListener(a,d.value),b.addEventListener(a,f.value)):(b[a]=f.value,b.setAttributeNS(f.namespaceURI,a,f.value)))}const m=(d.children||[]).slice(0),n=(a.children||[]).slice(0);let o=Math.max(m.length,n.length);for(let c=0;c<o;c++){const a=m[c],d=n[c];a&&d?h(a,d):d?f(b,d):g(a)}d.text!=a.text&&(b.textContent=a.text),a.dom=b};return{createElement:d,Component:class a{constructor(a={},b=[]){this.props=Object.seal(Object.assign({},a)),this.state={},this.children=b}setState(){let a;if(this.onBeforeSetState&&this.onBeforeSetState(),"string"==typeof arguments[0]){const b=arguments[0],c=arguments[1];this.state[b]=c,a=arguments[2]}else{const b=arguments[0];for(let a in b)this.state[a]=b[a];a=arguments[1]}this.onSetState&&this.onSetState(),(a||void 0===a)&&this.update()}saveState(){this.props.key||(this.props.key=b());try{const a=JSON.stringify({timestamp:Date.now(),data:this.state});return this.onBeforeSaveState&&this.onBeforeSaveState(),window.localStorage.setItem(this.props.key,a),this.onSaveState&&this.onSaveState(),!0}catch(a){return!1}}getSavedState(){if(this.props.key){const a=window.localStorage.getItem(this.props.key);if(a)try{return JSON.parse(a)}catch(a){}}}loadState(){if(!this.props.key)return!1;const a=window.localStorage.getItem(this.props.key);if(!a)return!1;try{const b=JSON.parse(a);return!!b.data&&(this.onBeforeLoadState&&this.onBeforeLoadState(),Object.assign(this.state,b.data),!0)}catch(a){return!1}this.onLoadState&&this.onLoadState()}mount(a){return this.vdom?void console.warn("Component already mounted."):void(this.onBeforeMount&&this.onBeforeMount(),this.props.onBeforeMount&&this.props.onBeforeMount(),this.vdom=this.render(),this.vdom.root=!0,this.vdom.parent=a,this.vdom.component=this,f(a,this.vdom),this.onMount&&this.onMount(),this.props.onMount&&this.props.onMount())}unmount(){return this.vdom&&this.vdom.dom?void(this.onBeforeUnmount&&this.onBeforeUnmount(),this.props.onBeforeUnmount&&this.props.onBeforeUnmount(),g(this.vdom),delete this.vdom,this.onUnmount&&this.onUnmount(),this.props.onUnmount&&this.props.onUnmount()):void console.warn("Attempted to unmount with no dom present.")}update(){if(!this.vdom)return;this.onBeforeUpdate&&this.onBeforeUpdate();const a=this.vdom.parent,b=this.render();h(this.vdom,b),this.vdom=b,this.vdom.parent=a,this.vdom.component=this,this.onUpdate&&this.onUpdate()}},uuid:b}}();
